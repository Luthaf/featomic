from mpmath import mp, hyp2f1
import numpy as np

mp.dps = 15
mp.maxterms = 20000
INFINITY = float("inf")

values = [
    (1.0, 2.0, 3.0, 0.0, 1.0),
    (0.0, 1.0, 0.0, 0.0, 1.0),
    (0.0, 0.0, 0.0, 0.0, 1.0),
    (0.0, 0.0, 0.0, -1.0, 1.0),
    (0.1, 1.0, 2.0, -5.0, 0.8923895138816937),
    (-2.0, -2.0, -3.0, 0.5, INFINITY),
    (-7.2, -0.5, -4.5, 1e-05, 0.999991999964571),
    (1.0, 2.0, -3.0, -1.0, INFINITY),
    (1.0, 0.5, -4.5, -20.0, 0.44674682523931875),
    (-1.0, -2.0, 3.0, 0.0, 1.0),
    (2.0, -2.0, -3.0, 0.5, INFINITY),
    (2.0, -3.0, -2.0, -1.0, INFINITY),
    (-7.2, 0.5, -4.5, 1e-05, 1.0000080001062877),
    (-1.0, 2.0, 3.0, 0.0, 1.0),
    (-1.0, -2.0, 4.0, -1.0, 0.5),
    (0.0, -6.0, -4.0, -2.0, INFINITY),
    (0.0, -3.0, -4.0, -1.0, INFINITY),
    (1.0, -6.0, -4.0, -1.0, INFINITY),
    (1.0, -0.5, -4.5, -5.0, 0.46975635247240194),
    (-7.2, -0.5, -4.5, -1.0, 19.915882647295806),
    (-1.0, -1.0, -2.0, -1.0, INFINITY),
    (-1.0, -1.0, -2.0, 0.0, INFINITY),
    (-1.0, -1.0, -2.0, 0.9, INFINITY),
    (-1.0, -1.0, -1.0, -1.0, INFINITY),
    (-1.0, -1.0, -1.0, 0.0, INFINITY),
    (-1.0, -1.0, -1.0, 0.9, INFINITY),
    (-1.0, -1.0, 0.0, 0.0, 1.0),
    (-1.0, 0.0, -2.0, -1.0, INFINITY),
    (-1.0, 0.0, -2.0, 0.0, INFINITY),
    (-1.0, 0.0, -2.0, 0.9, INFINITY),
    (-1.0, 0.0, -1.0, -1.0, INFINITY),
    (-1.0, 0.0, -1.0, 0.0, INFINITY),
    (-1.0, 0.0, -1.0, 0.9, INFINITY),
    (-1.0, 0.0, 0.0, -1.0, 1.0),
    (-1.0, 0.0, 0.0, 0.0, 1.0),
    (-1.0, 0.0, 0.0, 0.9, 1.0),
    (-1.0, 1.0, -2.0, -1.0, INFINITY),
    (-1.0, 1.0, -2.0, 0.0, INFINITY),
    (-1.0, 1.0, -2.0, 0.9, INFINITY),
    # (-1.0, 1.0, -1.0, -1.0, INFINITY),
    (-1.0, 1.0, -1.0, 0.0, INFINITY),
    (-1.0, 1.0, -1.0, 0.9, INFINITY),
    (-1.0, 1.0, 0.0, 0.0, 1.0),
    (0.0, -1.0, -2.0, -1.0, INFINITY),
    (0.0, -1.0, -2.0, 0.0, INFINITY),
    (0.0, -1.0, -2.0, 0.9, INFINITY),
    (0.0, -1.0, -1.0, -1.0, INFINITY),
    (0.0, -1.0, -1.0, 0.0, INFINITY),
    (0.0, -1.0, -1.0, 0.9, INFINITY),
    (0.0, -1.0, 0.0, -1.0, 2.0),
    (0.0, -1.0, 0.0, 0.0, 1.0),
    (0.0, -1.0, 0.0, 0.9, 0.09999999999999998),
    (0.0, 0.0, -2.0, -1.0, INFINITY),
    (0.0, 0.0, -2.0, 0.0, INFINITY),
    (0.0, 0.0, -2.0, 0.9, INFINITY),
    (0.0, 0.0, -1.0, -1.0, INFINITY),
    (0.0, 0.0, -1.0, 0.0, INFINITY),
    (0.0, 0.0, -1.0, 0.9, INFINITY),
    (0.0, 0.0, 0.0, -1.0, 1.0),
    (0.0, 0.0, 0.0, 0.0, 1.0),
    (0.0, 0.0, 0.0, 0.9, 1.0),
    (0.0, 1.0, -2.0, -1.0, INFINITY),
    (0.0, 1.0, -2.0, 0.0, INFINITY),
    (0.0, 1.0, -2.0, 0.9, INFINITY),
    (0.0, 1.0, -1.0, -1.0, INFINITY),
    (0.0, 1.0, -1.0, 0.0, INFINITY),
    (0.0, 1.0, -1.0, 0.9, INFINITY),
    (0.0, 1.0, 0.0, -1.0, 0.5 * 2.0),
    (0.0, 1.0, 0.0, 0.0, 1.0),
    (0.0, 1.0, 0.0, 0.9, 10.000000000000002),
    (1.0, -1.0, -2.0, -1.0, INFINITY),
    (1.0, -1.0, -2.0, 0.0, INFINITY),
    (1.0, -1.0, -2.0, 0.9, INFINITY),
    # (1.0, -1.0, -1.0, -1.0, INFINITY),
    (1.0, -1.0, -1.0, 0.0, INFINITY),
    (1.0, -1.0, -1.0, 0.9, INFINITY),
    (1.0, -1.0, 0.0, 0.0, 1.0),
    (1.0, 0.0, -2.0, -1.0, INFINITY),
    (1.0, 0.0, -2.0, 0.0, INFINITY),
    (1.0, 0.0, -2.0, 0.9, INFINITY),
    (1.0, 0.0, -1.0, -1.0, INFINITY),
    (1.0, 0.0, -1.0, 0.0, INFINITY),
    (1.0, 0.0, -1.0, 0.9, INFINITY),
    (1.0, 0.0, 0.0, -1.0, 1.0),
    (1.0, 0.0, 0.0, 0.0, 1.0),
    (1.0, 0.0, 0.0, 0.9, 1.0),
    (1.0, 1.0, -2.0, -1.0, INFINITY),
    (1.0, 1.0, -2.0, 0.0, INFINITY),
    (1.0, 1.0, -2.0, 0.9, INFINITY),
    (1.0, 1.0, -1.0, -1.0, INFINITY),
    (1.0, 1.0, -1.0, 0.0, INFINITY),
    (1.0, 1.0, -1.0, 0.9, INFINITY),
    (1.0, 1.0, 0.0, 0.0, 1.0),
]

# ps = np.array([1, 3, 6])
# nmax = 6
# zs = np.array([1e-3, 3e-2, 42, 1e3])
# for ip, p in enumerate(ps):
#     for n in [0, nmax]:
#         a = p / 2
#         b = (3 + n) / 2
#         c = (p + 2) / 2
#         for iz, z in enumerate(zs):
#             x = -z
#             print(
#                 f"({a}, {b}, {c}, {x}, {hyp2f1(a, b, c, x, maxterms=1e6, maxprec=1e6)}),"
#             )

actual = [
    (0.5, 1.5, 1.5, 0.23, 0.999500374687773),
    (0.5, 1.5, 1.5, 0.99, 0.999500374687773),
    (0.5, 1.5, 1.5, -0.001, 0.999500374687773),
    (0.5, 1.5, 1.5, -0.03, 0.985329278164293),
    (0.5, 1.5, 1.5, -42.0, 0.152498570332605),
    (0.5, 1.5, 1.5, -1000.0, 0.0316069770620507),
    #
    (0.5, 4.5, 1.5, -0.001, 0.998502471175221),
    (0.5, 4.5, 1.5, -0.03, 0.957128423470113),
    (0.5, 4.5, 1.5, -42.0, 0.0705386685734078),
    (0.5, 4.5, 1.5, -1000.0, 0.0144561264464801),
    #
    (1.5, 1.5, 2.5, -0.001, 0.999100802842932),
    (1.5, 1.5, 2.5, -0.03, 0.973704055664767),
    (1.5, 1.5, 2.5, -42.0, 0.017409586550297),
    (1.5, 1.5, 2.5, -1000.0, 0.000298624095345665),
    (1.5, 4.5, 2.5, -0.001, 0.99730529464762),
    (1.5, 4.5, 2.5, -0.03, 0.92354254735985),
    (1.5, 4.5, 2.5, -42.0, 0.000839723220491458),
    (1.5, 4.5, 2.5, -1000.0, 7.22806320748387e-6),
    #
    (3.0, 1.5, 4.0, -0.001, 0.998876123907304),
    (3.0, 1.5, 4.0, -0.03, 0.967233799071644),
    (3.0, 1.5, 4.0, -42.0, 0.00675325908887205),
    (3.0, 1.5, 4.0, -1000.0, 6.2976592595972e-5),
    #
    (3.0, 4.5, 4.0, -0.23, 0.996632411615264),
    (3.0, 4.5, 4.0, -0.001, 0.996632411615264),
    (3.0, 4.5, 4.0, -0.001, 0.996632411615264),
    (3.0, 4.5, 4.0, -0.03, 0.905087236117485),
    (3.0, 4.5, 4.0, -42.0, 6.07718118072915e-6),
    (3.0, 4.5, 4.0, -1000.0, 4.57079782017785e-10),
]

for a, b, c, x, _ in values:
    # if -x < 1:
    #     print(
    #         f"({a}, {b}, {c}, {-x}, {hyp2f1(a, b, c, -x, maxterms=1e6, maxprec=1e6)}),"
    #     )
    print(f"({a}, {b}, {c}, {x}, {hyp2f1(a, b, c, x, maxterms=1e6, maxprec=1e6)}),")
